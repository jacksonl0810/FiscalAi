# MAY Backend Environment Configuration
# Copy this file to .env and fill in your values

# ==============================================
# DATABASE
# ==============================================
DATABASE_URL="postgresql://user:password@localhost:5432/may_fiscal?schema=public"

# ==============================================
# JWT AUTHENTICATION
# ==============================================
JWT_SECRET="your-super-secret-jwt-key-change-in-production"
JWT_EXPIRES_IN="7d"
REFRESH_TOKEN_EXPIRES_IN="30d"

# ==============================================
# SERVER
# ==============================================
PORT=3001
NODE_ENV=development
FRONTEND_URL="http://localhost:5173"
CORS_ORIGIN="http://localhost:5173"

# ==============================================
# NUVEM FISCAL (NFS-e API)
# ==============================================
# Get credentials at: https://nuvemfiscal.com.br
NUVEM_FISCAL_CLIENT_ID=""
NUVEM_FISCAL_CLIENT_SECRET=""
NUVEM_FISCAL_ENVIRONMENT="sandbox"  # sandbox or production

# ==============================================
# PAGAR.ME (Payment Processing)
# ==============================================
# Get credentials at: https://pagar.me → Configurações → Chaves
PAGARME_API_KEY=""
PAGARME_SECRET_KEY=""
PAGARME_PUBLIC_KEY=""

# Webhook Secret for Pagar.me (CREATE YOUR OWN - Pagar.me does NOT auto-generate!)
# 
# SETUP STEPS:
# 1. Generate a secure random string: openssl rand -hex 32
# 2. Paste it below
# 3. Go to Pagar.me Dashboard → Configurações → Webhooks → Create webhook
# 4. Set URL: https://yourdomain.com/api/subscriptions/webhook?token=YOUR_SECRET
# 5. Select events: PEDIDO ✅, COBRANÇA ✅, ASSINATURA ✅
# 6. Save
#
# The token in the URL must match the value below!
# Example: 8ab77f526ca8e232e81ef489368a6f1f17cefdf5555799783230b790f24a52f0
PAGARME_WEBHOOK_SECRET=""

# ==============================================
# EMAIL CONFIGURATION
# ==============================================
EMAIL_ENABLED=true
EMAIL_FROM="MAY <onboarding@resend.dev>"

# Option 1: RESEND API (Recommended)
# Get your API key at: https://resend.com/api-keys
RESEND_API_KEY=""

# Option 2: SMTP (Fallback if RESEND_API_KEY is not set)
EMAIL_HOST="smtp.gmail.com"
EMAIL_PORT=587
EMAIL_USER=""
EMAIL_PASS=""

# For Gmail SMTP: Use app password (not regular password)
# 1. Enable 2FA on your Google account
# 2. Go to Security > App passwords
# 3. Generate new app password for "Mail"

# Alternative SMTP providers:
# SendGrid: smtp.sendgrid.net, port 587
# Mailgun: smtp.mailgun.org, port 587
# Amazon SES: email-smtp.us-east-1.amazonaws.com, port 587
# Resend SMTP: smtp.resend.com, port 587 (user: "resend", pass: your API key)

# ==============================================
# GOOGLE OAUTH (Gmail Login)
# ==============================================
# Create credentials at: https://console.cloud.google.com/apis/credentials
# 1. Create a new OAuth 2.0 Client ID
# 2. Add authorized redirect URI: http://localhost:3001/api/auth/google/callback
# 3. For production, add your domain: https://yourdomain.com/api/auth/google/callback

GOOGLE_CLIENT_ID=""
GOOGLE_CLIENT_SECRET=""
GOOGLE_REDIRECT_URI="http://localhost:3001/api/auth/google/callback"

# ==============================================
# OPENAI (AI Assistant)
# ==============================================
OPENAI_API_KEY=""
OPENAI_MODEL="gpt-4o-mini"  # or gpt-4, gpt-3.5-turbo

# ==============================================
# RATE LIMITING
# ==============================================
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX_REQUESTS=100
RATE_LIMIT_ASSISTANT_MAX=30
RATE_LIMIT_INVOICE_MAX=20

# ==============================================
# BACKGROUND TASKS
# ==============================================
ENABLE_BACKGROUND_TASKS=true
BACKGROUND_TASK_INTERVAL_MS=60000

# ==============================================
# SECURITY
# ==============================================
CREDENTIAL_ENCRYPTION_KEY=""  # 32-byte hex string for AES-256

# Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"

# ==============================================
# LOGGING
# ==============================================
LOG_LEVEL="info"  # error, warn, info, http, verbose, debug, silly
LOG_FORMAT="json"  # json or simple
